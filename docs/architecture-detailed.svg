<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="1200" viewBox="0 0 1600 1200">
    <!-- Title -->
    <text x="800" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="28" font-weight="700"
        fill="#111">Project Aura – Comprehensive Architecture (Tri-Store + Agent + Validation)</text>

    <!-- Legend -->
    <rect x="40" y="60" width="400" height="130" fill="#ffffff" stroke="#bbbbbb" stroke-width="1" rx="8" ry="8" />
    <text x="55" y="85" font-family="Arial, sans-serif" font-size="14" font-weight="700" fill="#111">Legend</text>
    <rect x="55" y="95" width="18" height="12" fill="#f7f2ff" stroke="#6c2bd0" stroke-width="1" />
    <text x="80" y="105" font-family="Arial, sans-serif" font-size="12" fill="#333">Core Services</text>
    <rect x="55" y="115" width="18" height="12" fill="#f0f7ff" stroke="#1b6fbf" stroke-width="1" />
    <text x="80" y="125" font-family="Arial, sans-serif" font-size="12" fill="#333">PostgreSQL (Structured)</text>
    <rect x="55" y="135" width="18" height="12" fill="#f7fff0" stroke="#5e8a2a" stroke-width="1" />
    <text x="80" y="145" font-family="Arial, sans-serif" font-size="12" fill="#333">MongoDB (Semi-structured)</text>
    <rect x="55" y="155" width="18" height="12" fill="#fef8e7" stroke="#d08a00" stroke-width="1" />
    <text x="80" y="165" font-family="Arial, sans-serif" font-size="12" fill="#333">File System
        (Unstructured/Artifacts)</text>

    <!-- UI Layer -->
    <rect x="40" y="210" width="360" height="120" fill="#ffffff" stroke="#2c3e50" stroke-width="2" rx="10" ry="10" />
    <text x="220" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="700"
        fill="#111">Streamlit UI</text>
    <text x="220" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" fill="#333">Upload ·
        Validate · Dashboards · Chat</text>
    <text x="220" y="285" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#555">Roles: Maker ·
        Reviewer · Business FC (demo personas)</text>

    <!-- Dev & Ops sidebar -->
    <rect x="420" y="210" width="360" height="120" fill="#ffffff" stroke="#888888" stroke-width="1" rx="10" ry="10" />
    <text x="600" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="700"
        fill="#111">Dev &amp; Ops</text>
    <text x="440" y="260" font-family="Arial, sans-serif" font-size="12" fill="#333">- environment.yml · .env
        (secrets)</text>
    <text x="440" y="276" font-family="Arial, sans-serif" font-size="12" fill="#333">- scripts/bootstrap.ps1
        (local-first)</text>
    <text x="440" y="292" font-family="Arial, sans-serif" font-size="12" fill="#333">- docker-compose (Postgres16,
        Mongo7, healthchecks)</text>
    <text x="440" y="308" font-family="Arial, sans-serif" font-size="12" fill="#333">- GitHub Actions · pre-commit ·
        tests</text>

    <!-- Core Services big box -->
    <rect x="40" y="360" width="1520" height="220" fill="#f7f2ff" stroke="#6c2bd0" stroke-width="2" rx="12" ry="12" />
    <text x="800" y="385" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="700"
        fill="#111">Core Services (Python 3.11)</text>

    <!-- Modules row 1 -->
    <rect x="60" y="400" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="175" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">data_ingestion.py</text>
    <text x="70" y="437" font-family="Arial, sans-serif" font-size="12" fill="#333">CSV/Excel → parse/normalize</text>
    <text x="70" y="453" font-family="Arial, sans-serif" font-size="12" fill="#333">Persist: PostgreSQL · Parquet
        cache</text>

    <rect x="310" y="400" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="425" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">data_validation.py</text>
    <text x="320" y="437" font-family="Arial, sans-serif" font-size="12" fill="#333">Great Expectations suites</text>
    <text x="320" y="453" font-family="Arial, sans-serif" font-size="12" fill="#333">Nil check · duplicates · required
        cols</text>

    <rect x="560" y="400" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="675" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">analytics.py</text>
    <text x="570" y="437" font-family="Arial, sans-serif" font-size="12" fill="#333">SQL aggregations · variance ·
        SLAs</text>
    <text x="570" y="453" font-family="Arial, sans-serif" font-size="12" fill="#333">Caches to Parquet for hot
        paths</text>

    <rect x="810" y="400" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="925" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">visualizations.py</text>
    <text x="820" y="437" font-family="Arial, sans-serif" font-size="12" fill="#333">Plotly charts · drill-down</text>
    <text x="820" y="453" font-family="Arial, sans-serif" font-size="12" fill="#333">TTFB ≤5s cached</text>

    <rect x="1060" y="400" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="1175" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">insights.py</text>
    <text x="1070" y="437" font-family="Arial, sans-serif" font-size="12" fill="#333">Proactive cards (period
        deltas)</text>
    <text x="1070" y="453" font-family="Arial, sans-serif" font-size="12" fill="#333">Guarded tool calls</text>

    <rect x="1310" y="400" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="1425" y="420" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">ml_model.py</text>
    <text x="1320" y="437" font-family="Arial, sans-serif" font-size="12" fill="#333">Scikit-learn baseline</text>
    <text x="1320" y="453" font-family="Arial, sans-serif" font-size="12" fill="#333">MLflow runs + rollback</text>

    <!-- Modules row 2 -->
    <rect x="60" y="480" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="175" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">agent.py</text>
    <text x="70" y="517" font-family="Arial, sans-serif" font-size="12" fill="#333">LangChain agent · tools
        orchestration</text>

    <rect x="310" y="480" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="425" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">langchain_tools.py</text>
    <text x="320" y="517" font-family="Arial, sans-serif" font-size="12" fill="#333">Pydantic tools: SQL · Mongo ·
        RAG</text>

    <rect x="560" y="480" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="675" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">vector_store.py</text>
    <text x="570" y="517" font-family="Arial, sans-serif" font-size="12" fill="#333">ChromaDB persistence ·
        embeddings</text>

    <rect x="810" y="480" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="925" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">feedback_handler.py</text>
    <text x="820" y="517" font-family="Arial, sans-serif" font-size="12" fill="#333">User corrections → retrain</text>

    <rect x="1060" y="480" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="1175" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">db modules</text>
    <text x="1070" y="517" font-family="Arial, sans-serif" font-size="12" fill="#333">postgres.py · mongodb.py ·
        storage.py</text>

    <rect x="1310" y="480" width="230" height="70" fill="#ffffff" stroke="#6c2bd0" stroke-width="1" rx="8" ry="8" />
    <text x="1425" y="500" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="700"
        fill="#111">app.py</text>
    <text x="1320" y="517" font-family="Arial, sans-serif" font-size="12" fill="#333">Streamlit pages · chat ·
        dashboards</text>

    <!-- Storage Layer Label -->
    <text x="800" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="700"
        fill="#111">Storage Layer (Tri-Store)</text>

    <!-- PostgreSQL box with schema + indexes -->
    <rect x="40" y="640" width="470" height="280" fill="#f0f7ff" stroke="#1b6fbf" stroke-width="2" rx="12" ry="12" />
    <text x="275" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="700"
        fill="#111">PostgreSQL 16 (Structured)</text>
    <text x="60" y="690" font-family="Arial, sans-serif" font-size="12" fill="#333">Tables: users, gl_accounts,
        responsibility_matrix, review_log</text>
    <text x="60" y="708" font-family="Arial, sans-serif" font-size="12" fill="#333">Key: UNIQUE(account_code, entity,
        period)</text>
    <text x="60" y="726" font-family="Arial, sans-serif" font-size="12" fill="#333">FK: review_log.gl_account_id →
        gl_accounts.id</text>
    <text x="60" y="744" font-family="Arial, sans-serif" font-size="12" fill="#333">Indexes: period, entity,
        review_status; review_log(gl_account_id)</text>
    <text x="60" y="762" font-family="Arial, sans-serif" font-size="12" fill="#333">Workloads: SQL analytics, joins,
        variance, SLAs</text>
    <text x="60" y="780" font-family="Arial, sans-serif" font-size="12" fill="#333">Users: app/demo (least-priv
        planned), admin (setup)</text>

    <!-- MongoDB box with collections + indexes -->
    <rect x="540" y="640" width="470" height="280" fill="#f7fff0" stroke="#5e8a2a" stroke-width="2" rx="12" ry="12" />
    <text x="775" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="700"
        fill="#111">MongoDB 7 (Semi-structured)</text>
    <text x="560" y="690" font-family="Arial, sans-serif" font-size="12" fill="#333">Collections: supporting_docs,
        audit_trail, validation_results</text>
    <text x="560" y="708" font-family="Arial, sans-serif" font-size="12" fill="#333">Indexes: gl_code; (gl_code,
        period); timestamp desc</text>
    <text x="560" y="726" font-family="Arial, sans-serif" font-size="12" fill="#333">Use: metadata, logs, validation
        JSON, comments</text>
    <text x="560" y="744" font-family="Arial, sans-serif" font-size="12" fill="#333">Audit: all actions
        (upload/validate/review/approve)</text>
    <text x="560" y="762" font-family="Arial, sans-serif" font-size="12" fill="#333">Roll-ups mirrored in PostgreSQL for
        reporting</text>

    <!-- Files / Vectors / Artifacts -->
    <rect x="1040" y="640" width="520" height="300" fill="#fef8e7" stroke="#d08a00" stroke-width="2" rx="12" ry="12" />
    <text x="1300" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="700"
        fill="#111">File System (Unstructured &amp; Artifacts)</text>
    <text x="1060" y="690" font-family="Arial, sans-serif" font-size="12" fill="#333">data/raw – CSV/Excel
        landing</text>
    <text x="1060" y="708" font-family="Arial, sans-serif" font-size="12" fill="#333">data/processed – Parquet cache
        (analytics)</text>
    <text x="1060" y="726" font-family="Arial, sans-serif" font-size="12" fill="#333">data/supporting_docs/{gl_code}/ –
        PDFs/Excels</text>
    <text x="1060" y="744" font-family="Arial, sans-serif" font-size="12" fill="#333">data/vectors/ – ChromaDB
        persistence</text>
    <text x="1060" y="762" font-family="Arial, sans-serif" font-size="12" fill="#333">mlruns/ – MLflow artifacts</text>
    <text x="1060" y="780" font-family="Arial, sans-serif" font-size="12" fill="#333">sample/ – demo datasets</text>

    <!-- Flows: UI → Ingestion → Stores -->
    <line x1="220" y1="330" x2="220" y2="360" stroke="#555" stroke-width="2" />
    <polygon points="216,356 224,356 220,366" fill="#555" />
    <text x="230" y="350" font-family="Arial, sans-serif" font-size="12" fill="#555">upload CSV/PDF</text>

    <line x1="175" y1="470" x2="275" y2="640" stroke="#555" stroke-width="2" />
    <polygon points="271,636 279,636 275,646" fill="#555" />
    <text x="210" y="560" font-family="Arial, sans-serif" font-size="12" fill="#555">normalized rows → PG</text>

    <line x1="175" y1="470" x2="590" y2="640" stroke="#2ca02c" stroke-width="2" />
    <polygon points="586,636 594,636 590,646" fill="#2ca02c" />
    <text x="340" y="600" font-family="Arial, sans-serif" font-size="12" fill="#2ca02c">upload metadata → Mongo
        (audit)</text>

    <line x1="175" y1="470" x2="1120" y2="640" stroke="#d08a00" stroke-width="2" />
    <polygon points="1116,636 1124,636 1120,646" fill="#d08a00" />
    <text x="750" y="605" font-family="Arial, sans-serif" font-size="12" fill="#d08a00">raw files → data/raw</text>

    <!-- Validation flow -->
    <line x1="425" y1="470" x2="760" y2="640" stroke="#2ca02c" stroke-width="2" />
    <polygon points="756,636 764,636 760,646" fill="#2ca02c" />
    <text x="540" y="600" font-family="Arial, sans-serif" font-size="12" fill="#2ca02c">GX results → Mongo
        (validation_results)</text>

    <line x1="425" y1="470" x2="260" y2="640" stroke="#1b6fbf" stroke-width="2" />
    <polygon points="256,636 264,636 260,646" fill="#1b6fbf" />
    <text x="320" y="610" font-family="Arial, sans-serif" font-size="12" fill="#1b6fbf">summary status → PG
        (review_log)</text>

    <line x1="425" y1="470" x2="1200" y2="640" stroke="#d08a00" stroke-width="2" />
    <polygon points="1196,636 1204,636 1200,646" fill="#d08a00" />
    <text x="900" y="615" font-family="Arial, sans-serif" font-size="12" fill="#d08a00">checkpoints →
        data/processed</text>

    <!-- Analytics cache flow -->
    <line x1="675" y1="470" x2="1240" y2="700" stroke="#555" stroke-width="2" />
    <polygon points="1236,696 1244,696 1240,706" fill="#555" />
    <text x="960" y="675" font-family="Arial, sans-serif" font-size="12" fill="#555">cache results → Parquet</text>

    <!-- Agent/RAG flows -->
    <line x1="675" y1="500" x2="300" y2="640" stroke="#555" stroke-width="2" />
    <polygon points="296,636 304,636 300,646" fill="#555" />
    <text x="480" y="595" font-family="Arial, sans-serif" font-size="12" fill="#555">SQL Tool → PG</text>

    <line x1="675" y1="500" x2="785" y2="640" stroke="#555" stroke-width="2" />
    <polygon points="781,636 789,636 785,646" fill="#555" />
    <text x="710" y="610" font-family="Arial, sans-serif" font-size="12" fill="#555">Mongo Tool → Mongo</text>

    <line x1="675" y1="500" x2="1300" y2="740" stroke="#6c2bd0" stroke-width="2" />
    <polygon points="1296,736 1304,736 1300,746" fill="#6c2bd0" />
    <text x="960" y="715" font-family="Arial, sans-serif" font-size="12" fill="#6c2bd0">RAG → vectors (ChromaDB)</text>

    <!-- Dev modes note -->
    <text x="800" y="980" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#333">Local-first
        development (no Docker required) · Docker Compose used for final 2-day integration</text>
    <text x="800" y="1000" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#555">Secrets via
        .env · Least-privilege DB user planned · Healthchecks on DB containers</text>

    <!-- KPIs footer -->
    <rect x="40" y="1020" width="1520" height="140" fill="#ffffff" stroke="#dddddd" stroke-width="1" rx="10" ry="10" />
    <text x="60" y="1045" font-family="Arial, sans-serif" font-size="14" font-weight="700" fill="#111">Pilot KPIs</text>
    <text x="60" y="1065" font-family="Arial, sans-serif" font-size="12" fill="#333">Ingestion ≥90% success · Nil check
        pass rate · TTFD ≤5s (cache) · p95 ≤250ms · RAG citations ≥80% · Learning +10% · 100% audit trail</text>
    <text x="60" y="1085" font-family="Arial, sans-serif" font-size="12" fill="#333">Reports: pending uploads · reviewed
        vs pending · SLA deviations · GL hygiene · major variances</text>
    <text x="60" y="1105" font-family="Arial, sans-serif" font-size="12" fill="#333">Artifacts: Architecture.md ·
        Storage-Architecture.md · Concept-Note.md · tests · CI</text>
</svg>